{% extends "base.html" %}

{% block content %}
<h2>Strategy Comparison Engine</h2>

<p style="color:#64748b">
Compare two business documents to evaluate strategic strength and effectiveness.
</p>

<div class="card">
    <h3>Select Documents</h3>
    <form method="POST">
        <div style="display:flex; gap:10px;">
            <select name="doc1" required style="flex:1">
                <option value="">Select First Document</option>
                {% for d in documents %}
                    <option value="{{ d._id }}">{{ d.filename }}</option>
                {% endfor %}
            </select>

            <select name="doc2" required style="flex:1">
                <option value="">Select Second Document</option>
                {% for d in documents %}
                    <option value="{{ d._id }}">{{ d.filename }}</option>
                {% endfor %}
            </select>
        </div>

        <button type="submit" style="margin-top:15px; width:100%">
            Run Comparative Analysis
        </button>
    </form>
</div>

{% if comparison %}
<div class="kpi-row">
    <div class="card" style="border-top: 4px solid #38bdf8;">
        <h4>{{ comparison.doc1.name }}</h4>
        <p style="color:#64748b">{{ comparison.doc1.focus }}</p>
        
        <p style="margin-top:10px"><b>Readiness:</b> {{ comparison.doc1.readiness }}%</p>
        <div class="progress"><div class="progress-bar" style="width:{{ comparison.doc1.readiness }}%"></div></div>

        <p style="margin-top:10px"><b>Risk Score:</b> {{ comparison.doc1.risk }}%</p>
        <div class="progress"><div class="progress-bar" style="width:{{ comparison.doc1.risk }}%; background:#ef4444"></div></div>
    </div>

    <div style="display:flex; align-items:center; font-weight:bold; color:#94a3b8; font-size:20px;">
        VS
    </div>

    <div class="card" style="border-top: 4px solid #22c55e;">
        <h4>{{ comparison.doc2.name }}</h4>
        <p style="color:#64748b">{{ comparison.doc2.focus }}</p>
        
        <p style="margin-top:10px"><b>Readiness:</b> {{ comparison.doc2.readiness }}%</p>
        <div class="progress"><div class="progress-bar" style="width:{{ comparison.doc2.readiness }}%"></div></div>

        <p style="margin-top:10px"><b>Risk Score:</b> {{ comparison.doc2.risk }}%</p>
        <div class="progress"><div class="progress-bar" style="width:{{ comparison.doc2.risk }}%; background:#ef4444"></div></div>
    </div>
</div>

<div class="card">
    <h3>AI Verdict</h3>
    <p style="font-size:18px; color:#0f172a;">
        üèÜ <b>Winner:</b> {{ comparison.winner }}
    </p>
    <p style="color:#475569; line-height:1.6;">
        {{ comparison.explanation }}
    </p>
</div>
{% endif %}

{% endblock %}